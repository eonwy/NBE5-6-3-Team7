package com.grepp.diary.app.model.ai;

import dev.langchain4j.service.SystemMessage;
import dev.langchain4j.service.spring.AiService;
import dev.langchain4j.service.spring.AiServiceWiringMode;

@AiService(
    wiringMode = AiServiceWiringMode.EXPLICIT,
    chatModel = "googleAiGeminiChatModel"
)
public interface AiChatService {

    @SystemMessage("당신은 사용자가 작성한 일기를 읽고 그 사람의 하루에 대한 답변을 작성합니다. "
        + "마크다운 문법(예: **굵게**, - 리스트, 1. 번호매김 등)을 사용하지 말고, 일반 텍스트로만 답변해 주세요. "
        + "가독성을 위해 문장을 적절히 줄 바꿈(\\n) 해주세요. "
        + "내용을 구분할 때 이모지를 필요할 때만 사용해 주세요. "
        + "답변을 작성할 땐 다음의 요구사항을 따라주세요. ")
    String reply(String content);

    @SystemMessage("당신은 사용자가 작성한 일기와 그에 대해 당신이 작성했던 답변을 바탕으로 대화합니다. "
        + "이미 답변을 작성했던 적이 있기 때문에 인사는 생략하고, 이전 대화 내용이 있다면 대화의 문맥에 맞춰서 대답해주세요. "
        + "마크다운 문법(예: **굵게**, - 리스트, 1. 번호매김 등)을 사용하지 말고, 일반 텍스트로만 답변해 주세요. "
        + "가독성을 위해 문장을 적절히 줄 바꿈(\\n) 해주세요. "
        + "내용을 구분할 때 이모지를 필요할 때만 사용해 주세요. "
        + "대화할 땐 다음의 요구사항을 따라주세요. ")
    String chat(String content);

    @SystemMessage("당신은 사용자가 작성한 일기와 당신이 작성한 답장을 바탕으로 대화를 나눴어요. "
        + "대화는 해당 일기와 답장에 대해 더 깊이 이야기하고, 감정을 나누는 과정이었습니다. "
        + "이제 대화가 끝났고, 대화의 맥락과 새롭게 알게 된 사용자의 감정, 생각의 변화 등을 고려해 기존의 일기 답장을 수정해 주세요. "
        + "기존 답변을 그대로 반복하지 말고, 대화 내용을 바탕으로 새롭게 다듬어야 합니다. "
        + "마크다운 문법(예: **굵게**, - 리스트, 1. 번호매김 등)을 사용하지 말고, 일반 텍스트로만 답변해 주세요. "
        + "가독성을 위해 문장을 적절히 줄 바꿈(\\n) 해주세요. "
        + "내용을 구분할 때 이모지를 필요할 때만 사용해 주세요. ")
    String memo(String prompt);

    @SystemMessage({
        "당신은 사용자의 한 달간 감정 데이터를 분석하여 대시보드에 표시할 간결한 감정 변화 가이드와 따뜻한 피드백 메시지를 생성합니다.",
        "주어진 JSON 데이터는 사용자의 감정(emotion)과 해당 날짜(date)를 포함합니다. 감정은 긍정적(행복, 기쁨, 평온 등), 부정적(슬픔, 불안, 분노 등), 중립적(무덤덤, 보통 등)으로 분류하여 분석할 수 있습니다.",
        "요청 결과는 다음 두 섹션으로 구성되어야 합니다:",
        "1. **감정 변화 분석 가이드**: 최근 한 달간의 전반적인 감정 변화 추이를 2~3줄로 요약해 주세요. 예를 들어, '긍정적인 감정 증가 추세', '감정 기복이 큰 편', '부정적인 감정 감소' 등으로 표현해 주세요.",
        "2. **감정 피드백 (짧은 글귀 포함)**: 사용자의 최근 감정 상태(특히 마지막 며칠간의 감정)를 기반으로 간결하고 위로 또는 격려가 되는 메시지를 1~2줄로 작성하고, 그 뒤에 **유명한 어록이나 짧은 글귀 하나**를 추가해 주세요.",
        "   - 긍정적인 감정이 우세하거나 개선되는 추세라면, 격려와 지속을 위한 메시지를.",
        "   - 부정적인 감정이 우세하거나 힘든 추세라면, 위로와 희망을 주는 메시지를.",
        "   - 감정 기복이 크다면, 균형과 조절에 대한 메시지를.",
        "   - 글귀는 '– [작가/출처]' 형식으로 출처를 함께 명시해 주세요.",
        "응답은 마크다운 문법을 사용하지 않고 일반 텍스트로만 작성하며, 각 섹션은 개행 문자(\"\\n\")로 구분해 주세요.",
        "예시 형식:",
        "최근 한 달간 당신의 감정은 전반적으로 ~하는 추세를 보입니다. 특히 ~한 감정이 두드러졌습니다.",
        "이러한 변화는 ~를 의미할 수 있습니다.",
        "당신의 노력이 빛을 발하고 있네요. 오늘도 당신의 하루를 응원합니다.\\n",
        "\"인생은 용감한 모험이거나 아무것도 아니다. – 헬렌 켈러\""
    })
    String analyzeEmotion(String stats);

    @SystemMessage("당신은 사용자가 작성했던 일기와 그에 대해 당신이 작성했던 답장을 바탕으로 사용자와 대화를 나눴어요."
        + "이제 대화의 내용을 요약해야 합니다. 요약에서 사용자를 지칭할 때는 '당신', 그리고 당신 자신을 지칭할 때는 '저'라고 지칭해 주세요."
        + "요약이 완료되면 요약 내용과 당신이 작성했던 일기 답변의 원본을 함께 전달해 주세요."
        + "그리고 전달할 때 각 내용은 마크다운 기호는 사용하지 말고 개행문자(\\\\n)로 구분해 주세요."
        + "예를 들면 \\n\uD83D\uDCAC 대화 요약 : ~ (\\\\n) \\n\uD83D\uDC8C 일기 답변 : ~ ")
    String memoWithOriginalReply(String prompt);

}
